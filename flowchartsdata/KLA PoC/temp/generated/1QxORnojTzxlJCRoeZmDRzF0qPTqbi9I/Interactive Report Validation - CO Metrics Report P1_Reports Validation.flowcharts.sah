_tfcLog("<div style='font-weight:bolder; font-size:15px;'>SubLabels : CO Metrics Report</div>", "RAW")

_focusWindow();
_sahi.setTFCModeEnabled();


/*Functions Start*/

_include("sahi_tfc_common.flowcharts.sah");


var $__tfcix=2;
var $__tfc_validation=false;
function _tfc_Login_3d_Experience() {
  if (!$__tfc_validation) _tfcLog($__tfcix+ "__tfcstart__:_tfc_Login_3d_Experience", "NO_LOG");

  if (!$__tfc_validation) _tfcLog("Login 3d Experience", "GROUP_START");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_setValue</td><td>_textbox(\"username\")</td><td>earivazh</td></tr></table>", "GROUP_START");
  _setValue(_textbox("username"), "earivazh");

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_setPassword</td><td>_password(\"password\")</td><td>\"*****\"</td></tr></table>", "GROUP_START");
  _setPassword(_password("password"), "enoviaKLA123", true);

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_click</td><td>_submit(\"Log in\")</td></tr></table>", "GROUP_START");
  _click(_submit("Log in"));

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_windowAction</td><td>maximize</td></tr></table>", "GROUP_START");
  _windowAction("maximize");

  _tfcLog("", "GROUP_END");


  if (!$__tfc_validation) { _tfcLog($__tfcix+ "__tfcend__", "NO_LOG");  $__tfcix++;  }

  if (!$__tfc_validation) { _tfcLog("", "GROUP_END"); }

}

function _tfc_Open_Co_Metrics_Report($co_metrics) {
  if (!$__tfc_validation) _tfcLog($__tfcix+ "__tfcstart__:_tfc_Open_Co_Metrics_Report", "NO_LOG");

  if (!$__tfc_validation) _tfcLog("Open $co_metrics Report", "GROUP_START");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_click</td><td>_div(\"add topbar-menu-item topbar-cmd enabled fonticon fonticon-plus\")</td></tr></table>", "GROUP_START");
  _click(_div("add topbar-menu-item topbar-cmd enabled fonticon fonticon-plus"));

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_click</td><td>_listItem(\"CO Metrics\")</td></tr></table>", "GROUP_START");
  _click(_listItem("CO Metrics"));

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_selectWindow</td><td>\"/ModalDialog/\"</td></tr></table>", "GROUP_START");
  _selectWindow("/ModalDialog/");

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_setValue</td><td>Start Date Input ($co_metrics)</td><td>$co_metrics.startDate</td></tr></table>", "GROUP_START");
  var $unescapeVar_2 = unescapeString($co_metrics.startDate);
  _setValue($co_metrics.accessors.attr_01720520209044[0].accessor, $unescapeVar_2);

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_setValue</td><td>End Date Input ($co_metrics)</td><td>$co_metrics.endDate</td></tr></table>", "GROUP_START");
  var $unescapeVar_2 = unescapeString($co_metrics.endDate);
  _setValue($co_metrics.accessors.attr_11720520209044[0].accessor, $unescapeVar_2);

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_setSelected</td><td>State Input ($co_metrics)</td><td>$co_metrics.state</td></tr></table>", "GROUP_START");
  var $option = convertToArray($co_metrics.state);
  _setSelected($co_metrics.accessors.attr_21720520209044[0].accessor, $option);

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_click</td><td>_button(\"Search\")</td></tr></table>", "GROUP_START");
  _click(_button("Search"));

  _tfcLog("", "GROUP_END");


  if (!$__tfc_validation) { _tfcLog($__tfcix+ "__tfcend__", "NO_LOG");  $__tfcix++;  }

  if (!$__tfc_validation) { _tfcLog("", "GROUP_END"); }

}

function _tfc_Validate_Co_Metrics_Report($co_metrics) {
  if (!$__tfc_validation) _tfcLog($__tfcix+ "__tfcstart__:_tfc_Validate_Co_Metrics_Report", "NO_LOG");

  if (!$__tfc_validation) _tfcLog("Validate $co_metrics Report", "GROUP_START");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>_selectWindow</td><td>\"/ModalDialog/\"</td></tr></table>", "GROUP_START");
  _selectWindow("/ModalDialog/");

  _tfcLog("", "GROUP_END");

  _tfcLog("<table class=\"tfc_step_table\"><tr><td>Raw Script</td></tr></table>", "GROUP_START");
var $i=0;
var $index= _getText(_cell("/of/"));
$index = $index.split(" ")[1];
_log($index);
while($i<$index){
var $CoState = _collectAttributes("_cell","/.*/","sahiText",_under(_tableHeader("State"),0));
var $dates =_collectAttributes("_cell","/.*/","sahiText",_under(_tableHeader("Create Date"),0),_in(_table("KLACOMetricsSearchResults")));
_log($dates);
for(var $i=0;$i<$CoState.length;$i++){
_assertEqual($co_metrics.state, $CoState[$i]);

var $startDateStr = $dates[$i];
_log($startDateStr )
var $inputFormatter = new java.text.SimpleDateFormat("M/d/yyyy hh:mm:ss a");
var $boundaryFormatter = new java.text.SimpleDateFormat("MMM d, yyyy");
 
var $startDate = $inputFormatter.parse($startDateStr);
 
// Define the boundaries
var $lowerBound = $boundaryFormatter.parse($co_metric.startDate);
var $upperBound = $boundaryFormatter.parse($co_metric.endDate);
 
// Check if the start date is within the bounds

var $isValid = $startDate.after($lowerBound) && $startDate.before($upperBound);
 
_assertTrue($isValid);
}

_click(_image("Next Page"));
$i++;
}

  _tfcLog("", "GROUP_END");


  if (!$__tfc_validation) { _tfcLog($__tfcix+ "__tfcend__", "NO_LOG");  $__tfcix++;  }

  if (!$__tfc_validation) { _tfcLog("", "GROUP_END"); }

}



/*Functions End*/


/*Data Start*/

var $s = null

/*Data End*/


/*Data Overrides Start*/



/*Data Overrides End*/



/*Function Calls Start*/

_tfc_Validate_Co_Metrics_Report($s.co_metrics[0]);


/*Function Calls End*/

